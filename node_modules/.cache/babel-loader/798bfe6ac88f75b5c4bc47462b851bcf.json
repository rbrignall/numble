{"ast":null,"code":"import { extends as _extends, objectWithoutPropertiesLoose as _objectWithoutPropertiesLoose } from '../../_virtual/_rollupPluginBabelHelpers.js';\nimport React, { useReducer, useEffect, useCallback, useMemo, createContext, useRef, useContext, Fragment } from 'react';\nimport { match } from '../../utils/match.esm.js';\nimport { render, forwardRefWithAs, Features } from '../../utils/render.esm.js';\nimport { useSyncRefs } from '../../hooks/use-sync-refs.esm.js';\nimport { Keys } from '../keyboard.esm.js';\nimport { isDisabledReactIssue7711 } from '../../utils/bugs.esm.js';\nimport { useId } from '../../hooks/use-id.esm.js';\nimport { OpenClosedProvider, State, useOpenClosed } from '../../internal/open-closed.esm.js';\nimport { useResolveButtonType } from '../../hooks/use-resolve-button-type.esm.js';\n\nvar _reducers;\n\nvar DisclosureStates;\n\n(function (DisclosureStates) {\n  DisclosureStates[DisclosureStates[\"Open\"] = 0] = \"Open\";\n  DisclosureStates[DisclosureStates[\"Closed\"] = 1] = \"Closed\";\n})(DisclosureStates || (DisclosureStates = {}));\n\nvar ActionTypes;\n\n(function (ActionTypes) {\n  ActionTypes[ActionTypes[\"ToggleDisclosure\"] = 0] = \"ToggleDisclosure\";\n  ActionTypes[ActionTypes[\"CloseDisclosure\"] = 1] = \"CloseDisclosure\";\n  ActionTypes[ActionTypes[\"SetButtonId\"] = 2] = \"SetButtonId\";\n  ActionTypes[ActionTypes[\"SetPanelId\"] = 3] = \"SetPanelId\";\n  ActionTypes[ActionTypes[\"LinkPanel\"] = 4] = \"LinkPanel\";\n  ActionTypes[ActionTypes[\"UnlinkPanel\"] = 5] = \"UnlinkPanel\";\n})(ActionTypes || (ActionTypes = {}));\n\nvar reducers = (_reducers = {}, _reducers[ActionTypes.ToggleDisclosure] = function (state) {\n  var _match;\n\n  return _extends({}, state, {\n    disclosureState: match(state.disclosureState, (_match = {}, _match[DisclosureStates.Open] = DisclosureStates.Closed, _match[DisclosureStates.Closed] = DisclosureStates.Open, _match))\n  });\n}, _reducers[ActionTypes.CloseDisclosure] = function (state) {\n  if (state.disclosureState === DisclosureStates.Closed) return state;\n  return _extends({}, state, {\n    disclosureState: DisclosureStates.Closed\n  });\n}, _reducers[ActionTypes.LinkPanel] = function (state) {\n  if (state.linkedPanel === true) return state;\n  return _extends({}, state, {\n    linkedPanel: true\n  });\n}, _reducers[ActionTypes.UnlinkPanel] = function (state) {\n  if (state.linkedPanel === false) return state;\n  return _extends({}, state, {\n    linkedPanel: false\n  });\n}, _reducers[ActionTypes.SetButtonId] = function (state, action) {\n  if (state.buttonId === action.buttonId) return state;\n  return _extends({}, state, {\n    buttonId: action.buttonId\n  });\n}, _reducers[ActionTypes.SetPanelId] = function (state, action) {\n  if (state.panelId === action.panelId) return state;\n  return _extends({}, state, {\n    panelId: action.panelId\n  });\n}, _reducers);\nvar DisclosureContext = /*#__PURE__*/createContext(null);\nDisclosureContext.displayName = 'DisclosureContext';\n\nfunction useDisclosureContext(component) {\n  var context = useContext(DisclosureContext);\n\n  if (context === null) {\n    var err = new Error(\"<\" + component + \" /> is missing a parent <\" + Disclosure.name + \" /> component.\");\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useDisclosureContext);\n    throw err;\n  }\n\n  return context;\n}\n\nvar DisclosureAPIContext = /*#__PURE__*/createContext(null);\nDisclosureAPIContext.displayName = 'DisclosureAPIContext';\n\nfunction useDisclosureAPIContext(component) {\n  var context = useContext(DisclosureAPIContext);\n\n  if (context === null) {\n    var err = new Error(\"<\" + component + \" /> is missing a parent <\" + Disclosure.name + \" /> component.\");\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useDisclosureAPIContext);\n    throw err;\n  }\n\n  return context;\n}\n\nvar DisclosurePanelContext = /*#__PURE__*/createContext(null);\nDisclosurePanelContext.displayName = 'DisclosurePanelContext';\n\nfunction useDisclosurePanelContext() {\n  return useContext(DisclosurePanelContext);\n}\n\nfunction stateReducer(state, action) {\n  return match(action.type, reducers, state, action);\n} // ---\n\n\nvar DEFAULT_DISCLOSURE_TAG = Fragment;\n\nfunction Disclosure(props) {\n  var _match2;\n\n  var _props$defaultOpen = props.defaultOpen,\n      defaultOpen = _props$defaultOpen === void 0 ? false : _props$defaultOpen,\n      passthroughProps = _objectWithoutPropertiesLoose(props, [\"defaultOpen\"]);\n\n  var buttonId = \"headlessui-disclosure-button-\" + useId();\n  var panelId = \"headlessui-disclosure-panel-\" + useId();\n  var reducerBag = useReducer(stateReducer, {\n    disclosureState: defaultOpen ? DisclosureStates.Open : DisclosureStates.Closed,\n    linkedPanel: false,\n    buttonId: buttonId,\n    panelId: panelId\n  });\n  var disclosureState = reducerBag[0].disclosureState,\n      dispatch = reducerBag[1];\n  useEffect(function () {\n    return dispatch({\n      type: ActionTypes.SetButtonId,\n      buttonId: buttonId\n    });\n  }, [buttonId, dispatch]);\n  useEffect(function () {\n    return dispatch({\n      type: ActionTypes.SetPanelId,\n      panelId: panelId\n    });\n  }, [panelId, dispatch]);\n  var close = useCallback(function (focusableElement) {\n    dispatch({\n      type: ActionTypes.CloseDisclosure\n    });\n\n    var restoreElement = function () {\n      if (!focusableElement) return document.getElementById(buttonId);\n      if (focusableElement instanceof HTMLElement) return focusableElement;\n      if (focusableElement.current instanceof HTMLElement) return focusableElement.current;\n      return document.getElementById(buttonId);\n    }();\n\n    restoreElement == null ? void 0 : restoreElement.focus();\n  }, [dispatch, buttonId]);\n  var api = useMemo(function () {\n    return {\n      close: close\n    };\n  }, [close]);\n  var slot = useMemo(function () {\n    return {\n      open: disclosureState === DisclosureStates.Open,\n      close: close\n    };\n  }, [disclosureState, close]);\n  return React.createElement(DisclosureContext.Provider, {\n    value: reducerBag\n  }, React.createElement(DisclosureAPIContext.Provider, {\n    value: api\n  }, React.createElement(OpenClosedProvider, {\n    value: match(disclosureState, (_match2 = {}, _match2[DisclosureStates.Open] = State.Open, _match2[DisclosureStates.Closed] = State.Closed, _match2))\n  }, render({\n    props: passthroughProps,\n    slot: slot,\n    defaultTag: DEFAULT_DISCLOSURE_TAG,\n    name: 'Disclosure'\n  }))));\n} // ---\n\n\nvar DEFAULT_BUTTON_TAG = 'button';\nvar Button = /*#__PURE__*/forwardRefWithAs(function Button(props, ref) {\n  var _useDisclosureContext = useDisclosureContext([Disclosure.name, Button.name].join('.')),\n      state = _useDisclosureContext[0],\n      dispatch = _useDisclosureContext[1];\n\n  var internalButtonRef = useRef(null);\n  var buttonRef = useSyncRefs(internalButtonRef, ref);\n  var panelContext = useDisclosurePanelContext();\n  var isWithinPanel = panelContext === null ? false : panelContext === state.panelId;\n  var handleKeyDown = useCallback(function (event) {\n    var _document$getElementB;\n\n    if (isWithinPanel) {\n      if (state.disclosureState === DisclosureStates.Closed) return;\n\n      switch (event.key) {\n        case Keys.Space:\n        case Keys.Enter:\n          event.preventDefault();\n          event.stopPropagation();\n          dispatch({\n            type: ActionTypes.ToggleDisclosure\n          });\n          (_document$getElementB = document.getElementById(state.buttonId)) == null ? void 0 : _document$getElementB.focus();\n          break;\n      }\n    } else {\n      switch (event.key) {\n        case Keys.Space:\n        case Keys.Enter:\n          event.preventDefault();\n          event.stopPropagation();\n          dispatch({\n            type: ActionTypes.ToggleDisclosure\n          });\n          break;\n      }\n    }\n  }, [dispatch, isWithinPanel, state.disclosureState]);\n  var handleKeyUp = useCallback(function (event) {\n    switch (event.key) {\n      case Keys.Space:\n        // Required for firefox, event.preventDefault() in handleKeyDown for\n        // the Space key doesn't cancel the handleKeyUp, which in turn\n        // triggers a *click*.\n        event.preventDefault();\n        break;\n    }\n  }, []);\n  var handleClick = useCallback(function (event) {\n    if (isDisabledReactIssue7711(event.currentTarget)) return;\n    if (props.disabled) return;\n\n    if (isWithinPanel) {\n      var _document$getElementB2;\n\n      dispatch({\n        type: ActionTypes.ToggleDisclosure\n      });\n      (_document$getElementB2 = document.getElementById(state.buttonId)) == null ? void 0 : _document$getElementB2.focus();\n    } else {\n      dispatch({\n        type: ActionTypes.ToggleDisclosure\n      });\n    }\n  }, [dispatch, props.disabled, state.buttonId, isWithinPanel]);\n  var slot = useMemo(function () {\n    return {\n      open: state.disclosureState === DisclosureStates.Open\n    };\n  }, [state]);\n  var type = useResolveButtonType(props, internalButtonRef);\n  var passthroughProps = props;\n  var propsWeControl = isWithinPanel ? {\n    ref: buttonRef,\n    type: type,\n    onKeyDown: handleKeyDown,\n    onClick: handleClick\n  } : {\n    ref: buttonRef,\n    id: state.buttonId,\n    type: type,\n    'aria-expanded': props.disabled ? undefined : state.disclosureState === DisclosureStates.Open,\n    'aria-controls': state.linkedPanel ? state.panelId : undefined,\n    onKeyDown: handleKeyDown,\n    onKeyUp: handleKeyUp,\n    onClick: handleClick\n  };\n  return render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_BUTTON_TAG,\n    name: 'Disclosure.Button'\n  });\n}); // ---\n\nvar DEFAULT_PANEL_TAG = 'div';\nvar PanelRenderFeatures = Features.RenderStrategy | Features.Static;\nvar Panel = /*#__PURE__*/forwardRefWithAs(function Panel(props, ref) {\n  var _useDisclosureContext2 = useDisclosureContext([Disclosure.name, Panel.name].join('.')),\n      state = _useDisclosureContext2[0],\n      dispatch = _useDisclosureContext2[1];\n\n  var _useDisclosureAPICont = useDisclosureAPIContext([Disclosure.name, Panel.name].join('.')),\n      close = _useDisclosureAPICont.close;\n\n  var panelRef = useSyncRefs(ref, function () {\n    if (state.linkedPanel) return;\n    dispatch({\n      type: ActionTypes.LinkPanel\n    });\n  });\n  var usesOpenClosedState = useOpenClosed();\n\n  var visible = function () {\n    if (usesOpenClosedState !== null) {\n      return usesOpenClosedState === State.Open;\n    }\n\n    return state.disclosureState === DisclosureStates.Open;\n  }(); // Unlink on \"unmount\" myself\n\n\n  useEffect(function () {\n    return function () {\n      return dispatch({\n        type: ActionTypes.UnlinkPanel\n      });\n    };\n  }, [dispatch]); // Unlink on \"unmount\" children\n\n  useEffect(function () {\n    var _props$unmount;\n\n    if (state.disclosureState === DisclosureStates.Closed && ((_props$unmount = props.unmount) != null ? _props$unmount : true)) {\n      dispatch({\n        type: ActionTypes.UnlinkPanel\n      });\n    }\n  }, [state.disclosureState, props.unmount, dispatch]);\n  var slot = useMemo(function () {\n    return {\n      open: state.disclosureState === DisclosureStates.Open,\n      close: close\n    };\n  }, [state, close]);\n  var propsWeControl = {\n    ref: panelRef,\n    id: state.panelId\n  };\n  var passthroughProps = props;\n  return React.createElement(DisclosurePanelContext.Provider, {\n    value: state.panelId\n  }, render({\n    props: _extends({}, passthroughProps, propsWeControl),\n    slot: slot,\n    defaultTag: DEFAULT_PANEL_TAG,\n    features: PanelRenderFeatures,\n    visible: visible,\n    name: 'Disclosure.Panel'\n  }));\n}); // ---\n\nDisclosure.Button = Button;\nDisclosure.Panel = Panel;\nexport { Disclosure };","map":{"version":3,"sources":["/Users/rbrignall/Documents/GitHub/numble/node_modules/@headlessui/react/src/components/disclosure/disclosure.tsx"],"names":["DisclosureStates","ActionTypes","reducers","disclosureState","match","state","Closed","linkedPanel","action","buttonId","panelId","DisclosureContext","createContext","context","useContext","err","Disclosure","Error","DisclosureAPIContext","DisclosurePanelContext","DEFAULT_DISCLOSURE_TAG","props","defaultOpen","passthroughProps","useId","reducerBag","useReducer","dispatch","useEffect","type","close","useCallback","CloseDisclosure","restoreElement","document","focusableElement","api","useMemo","slot","open","value","State","render","defaultTag","name","DEFAULT_BUTTON_TAG","Button","forwardRefWithAs","useDisclosureContext","internalButtonRef","useRef","buttonRef","useSyncRefs","panelContext","useDisclosurePanelContext","isWithinPanel","handleKeyDown","event","Keys","ToggleDisclosure","handleKeyUp","handleClick","isDisabledReactIssue7711","Open","useResolveButtonType","propsWeControl","ref","onKeyDown","onClick","id","onKeyUp","DEFAULT_PANEL_TAG","PanelRenderFeatures","Features","Panel","useDisclosureAPIContext","panelRef","LinkPanel","usesOpenClosedState","useOpenClosed","visible","UnlinkPanel","features"],"mappings":"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","sourcesContent":["// WAI-ARIA: https://www.w3.org/TR/wai-aria-practices-1.2/#disclosure\nimport React, {\n  Fragment,\n  createContext,\n  useCallback,\n  useContext,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n\n  // Types\n  Dispatch,\n  ElementType,\n  KeyboardEvent as ReactKeyboardEvent,\n  MouseEvent as ReactMouseEvent,\n  Ref,\n  MutableRefObject,\n  ContextType,\n} from 'react'\n\nimport { Props } from '../../types'\nimport { match } from '../../utils/match'\nimport { forwardRefWithAs, render, Features, PropsForFeatures } from '../../utils/render'\nimport { useSyncRefs } from '../../hooks/use-sync-refs'\nimport { useId } from '../../hooks/use-id'\nimport { Keys } from '../keyboard'\nimport { isDisabledReactIssue7711 } from '../../utils/bugs'\nimport { OpenClosedProvider, State, useOpenClosed } from '../../internal/open-closed'\nimport { useResolveButtonType } from '../../hooks/use-resolve-button-type'\n\nenum DisclosureStates {\n  Open,\n  Closed,\n}\n\ninterface StateDefinition {\n  disclosureState: DisclosureStates\n\n  linkedPanel: boolean\n\n  buttonId: string\n  panelId: string\n}\n\nenum ActionTypes {\n  ToggleDisclosure,\n  CloseDisclosure,\n\n  SetButtonId,\n  SetPanelId,\n\n  LinkPanel,\n  UnlinkPanel,\n}\n\ntype Actions =\n  | { type: ActionTypes.ToggleDisclosure }\n  | { type: ActionTypes.CloseDisclosure }\n  | { type: ActionTypes.SetButtonId; buttonId: string }\n  | { type: ActionTypes.SetPanelId; panelId: string }\n  | { type: ActionTypes.LinkPanel }\n  | { type: ActionTypes.UnlinkPanel }\n\nlet reducers: {\n  [P in ActionTypes]: (\n    state: StateDefinition,\n    action: Extract<Actions, { type: P }>\n  ) => StateDefinition\n} = {\n  [ActionTypes.ToggleDisclosure]: state => ({\n    ...state,\n    disclosureState: match(state.disclosureState, {\n      [DisclosureStates.Open]: DisclosureStates.Closed,\n      [DisclosureStates.Closed]: DisclosureStates.Open,\n    }),\n  }),\n  [ActionTypes.CloseDisclosure]: state => {\n    if (state.disclosureState === DisclosureStates.Closed) return state\n    return { ...state, disclosureState: DisclosureStates.Closed }\n  },\n  [ActionTypes.LinkPanel](state) {\n    if (state.linkedPanel === true) return state\n    return { ...state, linkedPanel: true }\n  },\n  [ActionTypes.UnlinkPanel](state) {\n    if (state.linkedPanel === false) return state\n    return { ...state, linkedPanel: false }\n  },\n  [ActionTypes.SetButtonId](state, action) {\n    if (state.buttonId === action.buttonId) return state\n    return { ...state, buttonId: action.buttonId }\n  },\n  [ActionTypes.SetPanelId](state, action) {\n    if (state.panelId === action.panelId) return state\n    return { ...state, panelId: action.panelId }\n  },\n}\n\nlet DisclosureContext = createContext<[StateDefinition, Dispatch<Actions>] | null>(null)\nDisclosureContext.displayName = 'DisclosureContext'\n\nfunction useDisclosureContext(component: string) {\n  let context = useContext(DisclosureContext)\n  if (context === null) {\n    let err = new Error(`<${component} /> is missing a parent <${Disclosure.name} /> component.`)\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useDisclosureContext)\n    throw err\n  }\n  return context\n}\n\nlet DisclosureAPIContext = createContext<{\n  close(focusableElement?: HTMLElement | MutableRefObject<HTMLElement | null>): void\n} | null>(null)\nDisclosureAPIContext.displayName = 'DisclosureAPIContext'\n\nfunction useDisclosureAPIContext(component: string) {\n  let context = useContext(DisclosureAPIContext)\n  if (context === null) {\n    let err = new Error(`<${component} /> is missing a parent <${Disclosure.name} /> component.`)\n    if (Error.captureStackTrace) Error.captureStackTrace(err, useDisclosureAPIContext)\n    throw err\n  }\n  return context\n}\n\nlet DisclosurePanelContext = createContext<string | null>(null)\nDisclosurePanelContext.displayName = 'DisclosurePanelContext'\n\nfunction useDisclosurePanelContext() {\n  return useContext(DisclosurePanelContext)\n}\n\nfunction stateReducer(state: StateDefinition, action: Actions) {\n  return match(action.type, reducers, state, action)\n}\n\n// ---\n\nlet DEFAULT_DISCLOSURE_TAG = Fragment\ninterface DisclosureRenderPropArg {\n  open: boolean\n  close(focusableElement?: HTMLElement | MutableRefObject<HTMLElement | null>): void\n}\n\nexport function Disclosure<TTag extends ElementType = typeof DEFAULT_DISCLOSURE_TAG>(\n  props: Props<TTag, DisclosureRenderPropArg> & {\n    defaultOpen?: boolean\n  }\n) {\n  let { defaultOpen = false, ...passthroughProps } = props\n  let buttonId = `headlessui-disclosure-button-${useId()}`\n  let panelId = `headlessui-disclosure-panel-${useId()}`\n\n  let reducerBag = useReducer(stateReducer, {\n    disclosureState: defaultOpen ? DisclosureStates.Open : DisclosureStates.Closed,\n    linkedPanel: false,\n    buttonId,\n    panelId,\n  } as StateDefinition)\n  let [{ disclosureState }, dispatch] = reducerBag\n\n  useEffect(() => dispatch({ type: ActionTypes.SetButtonId, buttonId }), [buttonId, dispatch])\n  useEffect(() => dispatch({ type: ActionTypes.SetPanelId, panelId }), [panelId, dispatch])\n\n  let close = useCallback(\n    (focusableElement?: HTMLElement | MutableRefObject<HTMLElement | null>) => {\n      dispatch({ type: ActionTypes.CloseDisclosure })\n\n      let restoreElement = (() => {\n        if (!focusableElement) return document.getElementById(buttonId)\n        if (focusableElement instanceof HTMLElement) return focusableElement\n        if (focusableElement.current instanceof HTMLElement) return focusableElement.current\n\n        return document.getElementById(buttonId)\n      })()\n\n      restoreElement?.focus()\n    },\n    [dispatch, buttonId]\n  )\n\n  let api = useMemo<ContextType<typeof DisclosureAPIContext>>(() => ({ close }), [close])\n\n  let slot = useMemo<DisclosureRenderPropArg>(\n    () => ({ open: disclosureState === DisclosureStates.Open, close }),\n    [disclosureState, close]\n  )\n\n  return (\n    <DisclosureContext.Provider value={reducerBag}>\n      <DisclosureAPIContext.Provider value={api}>\n        <OpenClosedProvider\n          value={match(disclosureState, {\n            [DisclosureStates.Open]: State.Open,\n            [DisclosureStates.Closed]: State.Closed,\n          })}\n        >\n          {render({\n            props: passthroughProps,\n            slot,\n            defaultTag: DEFAULT_DISCLOSURE_TAG,\n            name: 'Disclosure',\n          })}\n        </OpenClosedProvider>\n      </DisclosureAPIContext.Provider>\n    </DisclosureContext.Provider>\n  )\n}\n\n// ---\n\nlet DEFAULT_BUTTON_TAG = 'button' as const\ninterface ButtonRenderPropArg {\n  open: boolean\n}\ntype ButtonPropsWeControl =\n  | 'id'\n  | 'type'\n  | 'aria-expanded'\n  | 'aria-controls'\n  | 'onKeyDown'\n  | 'onClick'\n\nlet Button = forwardRefWithAs(function Button<TTag extends ElementType = typeof DEFAULT_BUTTON_TAG>(\n  props: Props<TTag, ButtonRenderPropArg, ButtonPropsWeControl>,\n  ref: Ref<HTMLButtonElement>\n) {\n  let [state, dispatch] = useDisclosureContext([Disclosure.name, Button.name].join('.'))\n  let internalButtonRef = useRef<HTMLButtonElement | null>(null)\n  let buttonRef = useSyncRefs(internalButtonRef, ref)\n\n  let panelContext = useDisclosurePanelContext()\n  let isWithinPanel = panelContext === null ? false : panelContext === state.panelId\n\n  let handleKeyDown = useCallback(\n    (event: ReactKeyboardEvent<HTMLButtonElement>) => {\n      if (isWithinPanel) {\n        if (state.disclosureState === DisclosureStates.Closed) return\n\n        switch (event.key) {\n          case Keys.Space:\n          case Keys.Enter:\n            event.preventDefault()\n            event.stopPropagation()\n            dispatch({ type: ActionTypes.ToggleDisclosure })\n            document.getElementById(state.buttonId)?.focus()\n            break\n        }\n      } else {\n        switch (event.key) {\n          case Keys.Space:\n          case Keys.Enter:\n            event.preventDefault()\n            event.stopPropagation()\n            dispatch({ type: ActionTypes.ToggleDisclosure })\n            break\n        }\n      }\n    },\n    [dispatch, isWithinPanel, state.disclosureState]\n  )\n\n  let handleKeyUp = useCallback((event: ReactKeyboardEvent<HTMLButtonElement>) => {\n    switch (event.key) {\n      case Keys.Space:\n        // Required for firefox, event.preventDefault() in handleKeyDown for\n        // the Space key doesn't cancel the handleKeyUp, which in turn\n        // triggers a *click*.\n        event.preventDefault()\n        break\n    }\n  }, [])\n\n  let handleClick = useCallback(\n    (event: ReactMouseEvent) => {\n      if (isDisabledReactIssue7711(event.currentTarget)) return\n      if (props.disabled) return\n\n      if (isWithinPanel) {\n        dispatch({ type: ActionTypes.ToggleDisclosure })\n        document.getElementById(state.buttonId)?.focus()\n      } else {\n        dispatch({ type: ActionTypes.ToggleDisclosure })\n      }\n    },\n    [dispatch, props.disabled, state.buttonId, isWithinPanel]\n  )\n\n  let slot = useMemo<ButtonRenderPropArg>(\n    () => ({ open: state.disclosureState === DisclosureStates.Open }),\n    [state]\n  )\n\n  let type = useResolveButtonType(props, internalButtonRef)\n  let passthroughProps = props\n  let propsWeControl = isWithinPanel\n    ? { ref: buttonRef, type, onKeyDown: handleKeyDown, onClick: handleClick }\n    : {\n        ref: buttonRef,\n        id: state.buttonId,\n        type,\n        'aria-expanded': props.disabled\n          ? undefined\n          : state.disclosureState === DisclosureStates.Open,\n        'aria-controls': state.linkedPanel ? state.panelId : undefined,\n        onKeyDown: handleKeyDown,\n        onKeyUp: handleKeyUp,\n        onClick: handleClick,\n      }\n\n  return render({\n    props: { ...passthroughProps, ...propsWeControl },\n    slot,\n    defaultTag: DEFAULT_BUTTON_TAG,\n    name: 'Disclosure.Button',\n  })\n})\n\n// ---\n\nlet DEFAULT_PANEL_TAG = 'div' as const\ninterface PanelRenderPropArg {\n  open: boolean\n  close: (focusableElement?: HTMLElement | MutableRefObject<HTMLElement | null>) => void\n}\ntype PanelPropsWeControl = 'id'\n\nlet PanelRenderFeatures = Features.RenderStrategy | Features.Static\n\nlet Panel = forwardRefWithAs(function Panel<TTag extends ElementType = typeof DEFAULT_PANEL_TAG>(\n  props: Props<TTag, PanelRenderPropArg, PanelPropsWeControl> &\n    PropsForFeatures<typeof PanelRenderFeatures>,\n  ref: Ref<HTMLDivElement>\n) {\n  let [state, dispatch] = useDisclosureContext([Disclosure.name, Panel.name].join('.'))\n  let { close } = useDisclosureAPIContext([Disclosure.name, Panel.name].join('.'))\n\n  let panelRef = useSyncRefs(ref, () => {\n    if (state.linkedPanel) return\n    dispatch({ type: ActionTypes.LinkPanel })\n  })\n\n  let usesOpenClosedState = useOpenClosed()\n  let visible = (() => {\n    if (usesOpenClosedState !== null) {\n      return usesOpenClosedState === State.Open\n    }\n\n    return state.disclosureState === DisclosureStates.Open\n  })()\n\n  // Unlink on \"unmount\" myself\n  useEffect(() => () => dispatch({ type: ActionTypes.UnlinkPanel }), [dispatch])\n\n  // Unlink on \"unmount\" children\n  useEffect(() => {\n    if (state.disclosureState === DisclosureStates.Closed && (props.unmount ?? true)) {\n      dispatch({ type: ActionTypes.UnlinkPanel })\n    }\n  }, [state.disclosureState, props.unmount, dispatch])\n\n  let slot = useMemo<PanelRenderPropArg>(\n    () => ({ open: state.disclosureState === DisclosureStates.Open, close }),\n    [state, close]\n  )\n  let propsWeControl = {\n    ref: panelRef,\n    id: state.panelId,\n  }\n  let passthroughProps = props\n\n  return (\n    <DisclosurePanelContext.Provider value={state.panelId}>\n      {render({\n        props: { ...passthroughProps, ...propsWeControl },\n        slot,\n        defaultTag: DEFAULT_PANEL_TAG,\n        features: PanelRenderFeatures,\n        visible,\n        name: 'Disclosure.Panel',\n      })}\n    </DisclosurePanelContext.Provider>\n  )\n})\n\n// ---\n\nDisclosure.Button = Button\nDisclosure.Panel = Panel\n"]},"metadata":{},"sourceType":"module"}